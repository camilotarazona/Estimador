PDFUser As screen:
    LoadingSpinnerColor: =RGBA(135, 100, 184, 1)

    Image1_17 As image:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =4
        Height: =768
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverFill: =RGBA(0, 0, 0, 0)
        Image: ='MicrosoftTeams-image'
        ImagePosition: =ImagePosition.Center
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =1366
        ZIndex: =1

    Label10_32 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Size: =13
        Text: =""
        Width: =1252
        X: =66
        Y: =73
        ZIndex: =2

    Label10_33 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =143
        Size: =13
        Text: =""
        Width: =436
        X: =106
        Y: =459
        ZIndex: =3

    Label12_16 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(229, 248, 254, 0.55)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =660
        Size: =13
        Text: =""
        Width: =1253
        X: =65
        Y: =73
        ZIndex: =4

    Rectangle2_98 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(160, 66, 227, 1)
        FocusedBorderThickness: =4
        Height: =68
        HoverFill: =RGBA(109, 49, 162, 1)
        PressedFill: =RGBA(109, 49, 162, 1)
        Width: =1366
        ZIndex: =5

    Label1_19 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(109, 49, 162, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Height: =60
        Size: =40
        Text: ="ESTIMATION"
        Width: =350
        X: =128
        Y: =65
        ZIndex: =6

    Rectangle1_50 As rectangle:
        BorderColor: =RGBA(255, 255, 255, 1)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        DisabledFill: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(109, 49, 162, 1)
        FocusedBorderThickness: =4
        Height: =7
        HoverFill: =RGBA(109, 49, 162, 1)
        PressedFill: =RGBA(109, 49, 162, 1)
        Width: =350
        X: =120
        Y: =125
        ZIndex: =7

    Icon1_10 As icon.AddDocument:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =50
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Home
        OnSelect: |-
            =Navigate(HomeUser,ScreenTransition.CoverRight);
            Reset(ComboBox1_10);
            Reset(ComboBox1_9);
            Reset(ComboBox1_8);
            Reset(ComboBox1_7);
            Reset(TxINI_1);
            Reset(TextInput2_2);
            Clear(colEstimacion);
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =50
        X: =15
        Y: =6
        ZIndex: =8

    Label4_9 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =37
        Size: =13
        Text: =User().Email
        Width: =328
        X: =1014
        Y: =15
        ZIndex: =9

    Label3_74 As label:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =2
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =42
        Size: =35
        Text: ="PDF Viewer"
        Width: =285
        X: =140
        Y: =19
        ZIndex: =10

    Icon4_10 As icon.BackArrow:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =50
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.BackArrow
        OnSelect: |
            =Navigate(SearchUser,ScreenTransition.CoverRight)
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Visible: =false
        Width: =50
        X: =78
        Y: =9
        ZIndex: =12

    Icon6_3 As icon.Send:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =50
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Send
        OnSelect: |-
            =Sendanemail.Run({file: {name:"pruebapdf.pdf", contentBytes: PDF(SearchUser)}})
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =45
        X: =942
        Y: =9
        ZIndex: =13

    "Gallery2_2 As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver4.0'":
        BorderColor: =RGBA(166, 166, 166, 1)
        Height: =208
        Items: |-
            =
            //Filter(pdf_Ofertas, Name= ComboBox2.Selected.Result)
            Last(pdf_Ofertas)
        Layout: =Layout.Vertical
        OnSelect: =Set(VartipoDocumento,ThisItem.'File name with extension')
        TemplatePadding: =0
        TemplateSize: =104
        Width: =391
        X: =74
        Y: =144
        ZIndex: =14

        Title5_2 As label:
            Color: =If(ThisItem.IsSelected,Color.MediumPurple,Color.Black)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =56
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =25
            Text: =ThisItem.Name
            Width: =340
            X: =22
            Y: =22
            ZIndex: =1

        NextArrow4_5 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(160, 66, 227, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =60
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Search
            OnSelect: =Select(Parent)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            TabIndex: =0
            Tooltip: ="View item details"
            Width: =60
            X: =Parent.TemplateWidth - Self.Width - 5
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =3

        Separator5_2 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =4

        NextArrow4_4 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(160, 66, 227, 1)
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =4
            Height: =60
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Download
            OnSelect: |-
                =Set(_fpdf,ThisItem.'Link to item');
                Launch(_fpdf)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(135, 100, 184, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            TabIndex: =0
            Tooltip: ="View item details"
            Width: =60
            X: =271
            Y: =18
            ZIndex: =5

    PdfViewer1_5 As pdfViewer:
        Document: |-
            =// para poder visualizar el archivo guardado en la libreria Pdf_Ofertas se incluye todo este codigo que se toma de la ruta creada por el link del archivo, seguido del metodo EncodeUrl
            "appres://datasources/pdf_Ofertas/table/22dc809c-388f-4235-bc12-67a2450364be/rows/3/reference/https:%2F%2Fmsmanaged-na.azure-apim.net%2Fapim%2Fsharepointonline%2F27a7363adb0c4f08a90b3d14c79df75c%2Fdatasets%2Fhttps%25253a%25252f%25252fts.accenture.com%25252fsites%25252fSUMA133%2FGetFileContentByPath%3Fpath=%252f"&EncodeUrl(Gallery2_2.Selected.'Full Path')
        Height: =646
        ShowControls: =true
        Width: =621
        X: =497
        Y: =91
        ZIndex: =15

    BtPatch_7 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        DisplayMode: |-
            =If(IsBlank(TxINI_1.Text),DisplayMode.Disabled, DisplayMode.Edit)
            // IsEmpty(If(IsBlank(CbxSelec_3.Value),DisplayMode.Disabled, DisplayMode.Edit)) 
        Fill: =RGBA(160, 66, 227, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Height: =70
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(135, 100, 184, 1), -10%)
        OnSelect: |-
            =ForAll(
                colEstimacion,
                Patch(
                    Estimacion,
                    Defaults(Estimacion),
                    {
                        NumeroINI:NumeroINI,
                        Clasificacion: Clasificacion,
                        TipoEstimacion: TipoEstimacion,
                        Descripcion: Descripcion,
                        Complejidad: Complejidad,
                        Esfuerzo:Esfuerzo,
                        'Comentario Estimacion': 'Comentario Estimacion',
                        Aplicacion: Aplicacion,
                        'Fecha Estimacion': DatePicker1_1.SelectedDate,
                        'Comentario General': TextInput2_2.Text
                        
                    }
                )
            );
            
            ClearCollect(ColDatosOferta,
                {   
                        Title: TxINI.Text,
                        Configuraion_Desarrollo:LbConfDes.Text,
                        Apoyo_Pruebas: LbApo.Text,
                        Entrega_linea_Base: LbEnLiBas.Text,
                        '%_Riesgo': LbRiesg.Text,
                        Total_Sin_Riesgo: LbTSinR.Text,
                        Total: LbTtal.Text
                    }
            );
            ForAll(
                ColDatosOferta,
                Patch(
                    Oferta,
                    Defaults(Oferta),
                    {
                        Title:TxINI.Text,
                        Configuraion_Desarrollo:LbConfDes.Text,
                        Apoyo_Pruebas: LbApo.Text,
                        Entrega_linea_Base: LbEnLiBas.Text,
                        '%_Riesgo': LbRiesg.Text,
                        Total_Sin_Riesgo: LbTSinR.Text,
                        Total: LbTtal.Text
                    }
                ));
            ClearCollect(ColDatosOfertaInt,
                {   
                        Title: TxINI.Text,
                        Gestion: LbRG.Text,
                        Configuraion_Desarrollo:LbRConf.Text,
                        Pruebas: LbRPrue.Text,
                        Documentacion: LbRDoc.Text,
                        Gestion_del_Cambio: LbRGstC.Text,
                        Total: LbtotalH.Text
                    }
            );
            ForAll(
                ColDatosOfertaInt,
                Patch(
                    Oferta_Interna,
                    Defaults(Oferta_Interna),
                    {
                        Title: TxINI.Text,
                        Gestion: LbRG.Text,
                        Configuracion_Desarrollo:LbRConf.Text,
                        Pruebas: LbRPrue.Text,
                        Documentacion: LbRDoc.Text,
                        Gestion_del_Cambio: LbRGstC.Text,
                        Total: LbtotalH.Text
            
                        
                    }
                ));
            Notify(
                "INI "&TxINI_1.Text&"  Guardada con exito",
                NotificationType.Success,
                2000
            );
            Navigate(OfertUser,ScreenTransition.Cover)
            //Navigate(Details,ScreenTransition.Cover)
        PressedBorderColor: =ColorFade(RGBA(135, 100, 184, 1), -50%)
        PressedColor: =RGBA(39, 113, 194, 1)
        PressedFill: =ColorFade(RGBA(135, 100, 184, 1), -30%)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =15
        Text: ="Guardar Estimacion"
        Width: =150
        X: =1152
        Y: =650
        ZIndex: =16

